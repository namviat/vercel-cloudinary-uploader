import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';
// --- 1. Firebase Imports & Utilities (MANDATORY) -------------------------------
import { initializeApp, getApp } from 'firebase/app';
import { getAuth, signInAnonymously, signOut, onAuthStateChanged } from 'firebase/auth';
import { getFirestore, doc, onSnapshot, collection, query, setDoc, serverTimestamp, deleteDoc, where, getDocs, writeBatch } from 'firebase/firestore';
// Global variables provided by the environment
const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : undefined;
let db, auth;
// --- 2. Custom Styles and Icon Definitions -------------------------------------
// Since external CSS is not allowed, custom styles are defined here for the theme.
const customStyles = `
/* Custom Fonts */
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;700&family=Rajdhani:wght@600&display=swap');
.font-orbitron { font-family: 'Orbitron', sans-serif; }
.font-inter { font-family: 'Inter', sans-serif; }
.font-jetbrains { font-family: 'JetBrains Mono', monospace; }
.font-rajdhani { font-family: 'Rajdhani', sans-serif; }
/* Custom Colors & Glows (Tailwind-like variables) */
.bg-background { background-color: #0A0A0A; }
.bg-card { background-color: #1C1C1E; }
.bg-input { background-color: #2C2C2E; }
.text-foreground { color: #FAFAFA; }
.text-primary { color: #00D4FF; }
.text-secondary { color: #8B5CF6; }
.text-accent { color: #FF8C00; }
.text-destructive { color: #EF4444; }
.text-warning { color: #F59E0B; }
.text-muted-foreground { color: #A1A1AA; }
.border-glow { border-color: rgba(0, 212, 255, 0.1); } /* primary/10 */
/* Custom Effects */
.glow-primary { box-shadow: 0 0 10px rgba(0, 212, 255, 0.5); }
.glow-primary-strong { box-shadow: 0 0 20px rgba(0, 212, 255, 0.8), 0 0 30px rgba(139, 92, 246, 0.4); }
.glow-accent { box-shadow: 0 0 10px rgba(255, 140, 0, 0.5); }
.glow-secondary { box-shadow: 0 0 10px rgba(139, 92, 246, 0.5); }
.depth-shadow { box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05); }
/* Animation Keyframes */
@keyframes float {
  0% { transform: translateY(0) rotate(0deg); opacity: 0.8; }
  50% { transform: translateY(-10px) rotate(5deg); opacity: 1; }
  100% { transform: translateY(0) rotate(0deg); opacity: 0.8; }
}
.animate-float { animation: float 6s ease-in-out infinite; }
@keyframes pulse-slow {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}
.animate-pulse-slow { animation: pulse-slow 5s ease-in-out infinite; }
.transition-smooth { transition: all 0.3s ease-out; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
.animate-spin { animation: spin 1s linear infinite; }
@keyframes glow-pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
.animate-glow-pulse { animation: glow-pulse 2s ease-in-out infinite; }
.bg-gradient-to-br { background: linear-gradient(to bottom right, var(--color-primary), var(--color-secondary)); }
.bg-gradient-to-r { background: linear-gradient(to right, var(--color-primary), var(--color-secondary)); }
.bg-clip-text { -webkit-background-clip: text; background-clip: text; }
.backdrop-blur-xl { backdrop-filter: blur(20px); }
.rounded-xl { border-radius: 12px; }
.rounded-2xl { border-radius: 16px; }
.p-6 { padding: 1.5rem; }
.mb-4 { margin-bottom: 1rem; }
.mb-6 { margin-bottom: 1.5rem; }
.mb-8 { margin-bottom: 2rem; }
.mb-12 { margin-bottom: 3rem; }
.mt-4 { margin-top: 1rem; }
.mt-6 { margin-top: 1.5rem; }
.mt-24 { margin-top: 6rem; }
.py-8 { padding-top: 2rem; padding-bottom: 2rem; }
.py-12 { padding-top: 3rem; padding-bottom: 3rem; }
.px-4 { padding-left: 1rem; padding-right: 1rem; }
.px-8 { padding-left: 2rem; padding-right: 2rem; }
.text-center { text-align: center; }
.flex { display: flex; }
.items-center { align-items: center; }
.justify-center { justify-content: center; }
.justify-between { justify-content: space-between; }
.gap-2 { gap: 0.5rem; }
.gap-4 { gap: 1rem; }
.gap-6 { gap: 1.5rem; }
.gap-8 { gap: 2rem; }
.w-full { width: 100%; }
.max-w-md { max-width: 28rem; }
.max-w-2xl { max-width: 42rem; }
.max-w-4xl { max-width: 56rem; }
.max-w-6xl { max-width: 72rem; }
.max-w-7xl { max-width: 80rem; }
.mx-auto { margin-left: auto; margin-right: auto; }
.hidden { display: none; }
.grid { display: grid; }
.grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
.md\\:grid-cols-2 { } /* Media queries below */
.lg\\:grid-cols-3 { }
@media (min-width: 768px) { .md\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
@media (min-width: 1024px) { .lg\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); } }
.border { border-width: 1px; }
.border-b { border-bottom-width: 1px; }
.bg-card { background-color: #1C1C1E; }
.bg-muted { background-color: #2C2C2E; }
.text-foreground { color: #FAFAFA; }
.text-muted-foreground { color: #A1A1AA; }
.text-primary { color: #00D4FF; }
.text-destructive { color: #EF4444; }
.font-bold { font-weight: 700; }
.font-semibold { font-weight: 600; }
.text-xl { font-size: 1.25rem; }
.text-3xl { font-size: 1.875rem; }
.text-4xl { font-size: 2.25rem; }
.leading-relaxed { line-height: 1.625; }
.space-y-4 > * + * { margin-top: 1rem; }
.space-y-6 > * + * { margin-top: 1.5rem; }
.rounded-full { border-radius: 9999px; }
.rounded-lg { border-radius: 8px; }
.p-4 { padding: 1rem; }
.pt-4 { padding-top: 1rem; }
.absolute { position: absolute; }
.inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
.top-0 { top: 0; }
.left-0 { left: 0; }
.right-0 { right: 0; }
.bottom-0 { bottom: 0; }
.z-10 { z-index: 10; }
.z-20 { z-index: 20; }
.z-30 { z-index: 30; }
.z-50 { z-index: 50; }
.overflow-hidden { overflow: hidden; }
.overflow-auto { overflow: auto; }
.cursor-pointer { cursor: pointer; }
.opacity-20 { opacity: 0.2; }
.opacity-50 { opacity: 0.5; }
.hover\\:opacity-80:hover { opacity: 0.8; }
.hover\\:scale-105:hover { transform: scale(1.05); }
.hover\\:bg-muted:hover { background-color: #2C2C2E; }
.focus\\:ring-2:focus { box-shadow: 0 0 0 2px #00D4FF; }
.focus\\:outline-none:focus { outline: none; }
.disabled\\:opacity-50:disabled { opacity: 0.5; }
.disabled\\:cursor-not-allowed:disabled { cursor: not-allowed; }
.min-h-screen { min-height: 100vh; }
.fixed { position: fixed; }
.bg-black { background-color: black; }
.pt-20 { padding-top: 5rem; }
.border-t { border-top-width: 1px; }
.flex-col { flex-direction: column; }
.sm\\:flex-row { }
@media (min-width: 640px) { .sm\\:flex-row { flex-direction: row; } }
.lg\\:col-span-2 { }
.lg\\:col-span-1 { }
@media (min-width: 1024px) { .lg\\:col-span-2 { grid-column: span 2 / span 2; } .lg\\:col-span-1 { grid-column: span 1 / span 1; } }
.sticky { position: sticky; }
.top-24 { top: 6rem; }
.w-96 { width: 24rem; }
.max-w-\\[calc\\(100vw-4rem\\)\\] { max-width: calc(100vw - 4rem); }
.max-h-96 { max-height: 24rem; }
.last\\:border-b-0:last-child { border-bottom-width: 0; }
.truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.break-all { word-break: break-all; }
.aspect-square { aspect-ratio: 1; }
.object-cover { object-fit: cover; }
.h-1\\.5 { height: 0.375rem; }
.text-xs { font-size: 0.75rem; }
.text-sm { font-size: 0.875rem; }
.tracking-widest { letter-spacing: 0.1em; }
.pt-8 { padding-top: 2rem; }
.block { display: block; }
.contents { display: contents; }
.col-span-1 { grid-column: span 1 / span 1; }
.md\\:col-span-2 { }
@media (min-width: 768px) { .md\\:col-span-2 { grid-column: span 2 / span 2; } }
.sm\\:gap-4 { }
@media (min-width: 640px) { .sm\\:gap-4 { gap: 1rem; } }
.flex-1 { flex: 1 1 0%; }
.min-w-0 { min-width: 0; }
.mr-2 { margin-right: 0.5rem; }
.flex-shrink-0 { flex-shrink: 0; }
.w-8 { width: 2rem; }
.h-8 { height: 2rem; }
.w-3 { width: 0.75rem; }
.h-3 { height: 0.75rem; }
.w-2 { width: 0.5rem; }
.h-2 { height: 0.5rem; }
.mt-0\\.5 { margin-top: 0.125rem; }
.mt-2 { margin-top: 0.5rem; }
.w-14 { width: 3.5rem; }
.h-14 { height: 3.5rem; }
.w-12 { width: 3rem; }
.h-12 { height: 3rem; }
.w-6 { width: 1.5rem; }
.h-6 { height: 1.5rem; }
.w-16 { width: 4rem; }
.h-16 { height: 4rem; }
.w-32 { width: 8rem; }
.h-32 { height: 8rem; }
.w-64 { width: 16rem; }
.h-64 { height: 16rem; }
.h-40 { height: 10rem; }
.h-24 { height: 6rem; }
.h-4 { height: 1rem; }
.h-2 { height: 0.5rem; }
.p-3 { padding: 0.75rem; }
.p-1 { padding: 0.25rem; }
.p-1\\.5 { padding: 0.375rem; }
.-bottom-1 { bottom: -0.25rem; }
.-right-1 { right: -0.25rem; }
.-translate-x-1\\/2 { transform: translateX(-50%); }
.-translate-y-1\\/2 { transform: translateY(-50%); }
.scale-110 { transform: scale(1.1); }
.border-2 { border-width: 2px; }
.bg-primary\\/10 { background-color: rgba(0, 212, 255, 0.1); }
.bg-primary\\/20 { background-color: rgba(0, 212, 255, 0.2); }
.bg-destructive\\/10 { background-color: rgba(239, 68, 68, 0.1); }
.bg-destructive\\/20 { background-color: rgba(239, 68, 68, 0.2); }
.bg-accent\\/20 { background-color: rgba(255, 140, 0, 0.2); }
.bg-primary { background-color: #00D4FF; }
.text-primary-foreground { color: #0A0A0A; }
.border-primary { border-color: #00D4FF; }
.hover\\:bg-primary\\/90:hover { background-color: rgba(0, 212, 255, 0.9); }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.hover\\:bg-accent:hover { background-color: #FF8C00; }
.hover\\:text-accent-foreground:hover { color: #0A0A0A; }
.text-onBackground { color: #FAFAFA; }
.bg-background { background-color: #0A0A0A; }
.p-2 { padding: 0.5rem; }
.gap-3 { gap: 0.75rem; }
.text-2xl { font-size: 1.5rem; }
.font-medium { font-weight: 500; }
.opacity-70 { opacity: 0.7; }
.text-9xl { font-size: 8rem; }
.mb-6 { margin-bottom: 1.5rem; }
.max-w-md { max-width: 28rem; }
.inline-flex { display: inline-flex; }
.px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
.duration-200 { transition-duration: 200ms; }
.w-48 { width: 12rem; }
.shadow-depth-shadow { box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05); }
.overflow-hidden { overflow: hidden; }
.text-left { text-align: left; }
.justify-start { justify-content: flex-start; }
.flex-wrap { flex-wrap: wrap; }
.sm\\:flex-nowrap { }
@media (min-width: 640px) { .sm\\:flex-nowrap { flex-wrap: nowrap; } }
.border-x { border-left-width: 1px; border-right-width: 1px; }
.border-primary\\/50 { border-color: rgba(0, 212, 255, 0.5); }
.hover\\:border-primary\\/50:hover { border-color: rgba(0, 212, 255, 0.5); }
.grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
.sm\\:grid-cols-2 { }
.lg\\:grid-cols-3 { }
.gap-4 { gap: 1rem; }
.sm\\:grid-cols-2 { }
@media (min-width: 640px) { .sm\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
.lg\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
@media (min-width: 1024px) { .lg\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); } }
.bg-card\\/50 { background-color: rgba(28, 28, 30, 0.5); }
.border-primary\\/30 { border-color: rgba(0, 212, 255, 0.3); }
.bg-primary\\/30 { background-color: rgba(0, 212, 255, 0.3); }
.bg-secondary\\/50 { background-color: rgba(139, 92, 246, 0.5); }
.bg-accent\\/30 { background-color: rgba(255, 140, 0, 0.3); }
.bg-transparent { background-color: transparent; }
.rotate-45 { transform: rotate(45deg); }
.rotate-12 { transform: rotate(12deg); }
.top-1\\/4 { top: 25%; }
.left-1\\/4 { left: 25%; }
.bottom-1\\/4 { bottom: 25%; }
.right-1\\/4 { right: 25%; }
.top-1\\/3 { top: 33.333%; }
.right-1\\/3 { right: 33.333%; }
.bottom-8 { bottom: 2rem; }
.left-1\\/2 { left: 50%; }
.-translate-x-1\\/2 { transform: translateX(-50%); }
.text-6xl { font-size: 3.75rem; }
.font-black { font-weight: 900; }
.mt-2 { margin-top: 0.5rem; }
.tracking-widest { letter-spacing: 0.1em; }
.relative { position: relative; }
.overflow-hidden { overflow: hidden; }
.w-full { width: 100%; }
.h-96 { height: 24rem; }
.flex { display: flex; }
.items-center { align-items: center; }
.justify-center { justify-content: center; }
.animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
.w-16 { width: 4rem; }
.h-16 { height: 4rem; }
.border-primary { border-color: #00D4FF; }
.rounded-full { border-radius: 50%; }
.object-cover { object-fit: cover; }
.bg-gradient-to-br { background: linear-gradient(to bottom right, #00D4FF, #8B5CF6); }
.-bottom-1 { bottom: -4px; }
.-right-1 { right: -4px; }
.scale-110 { transform: scale(1.1); }
.h-2 { height: 8px; }
.bg-muted { background-color: #2C2C2E; }
.rounded-full { border-radius: 9999px; }
.overflow-hidden { overflow: hidden; }
.bg-gradient-to-r { background: linear-gradient(to right, #00D4FF, #8B5CF6); }
.transition-all { transition-property: all; }
.duration-500 { transition-duration: 500ms; }
.p-3 { padding: 12px; }
.bg-muted { background-color: #2C2C2E; }
.rounded-lg { border-radius: 8px; }
.flex-shrink-0 { flex-shrink: 0; }
.mt-0\\.5 { margin-top: 2px; }
.w-2 { width: 8px; }
.h-2 { height: 8px; }
.animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
.fixed { position: fixed; }
.bottom-8 { bottom: 2rem; }
.left-1\\/2 { left: 50%; }
.-translate-x-1\\/2 { transform: translateX(-50%); }
.z-30 { z-index: 30; }
.w-px { width: 1px; }
.h-6 { height: 1.5rem; }
.px-4 { padding-left: 1rem; padding-right: 1rem; }
.py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
.gap-3 { gap: 0.75rem; }
.text-left { text-align: left; }
.w-56 { width: 14rem; }
.right-0 { right: 0; }
.mt-2 { margin-top: 0.5rem; }
.justify-between { justify-content: space-between; }
.border-t { border-top-width: 1px; }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.text-warning { color: #F59E0B; }
.inset-0 { inset: 0px; }
.bg-background\\/80 { background-color: rgba(10, 10, 10, 0.8); }
.backdrop-blur-sm { backdrop-filter: blur(4px); }
.z-50 { z-index: 50; }
.p-4 { padding: 1rem; }
.max-w-md { max-width: 28rem; }
.flex-col { flex-direction: column; }
.sm\\:flex-row { }
.items-start { align-items: flex-start; }
.sm\\:items-center { }
@media (min-width: 640px) { .sm\\:items-center { align-items: center; } }
.pl-12 { padding-left: 3rem; }
.pr-4 { padding-right: 1rem; }
.py-4 { padding-top: 1rem; padding-bottom: 1rem; }
.bg-input { background-color: #2C2C2E; }
.placeholder\\:text-muted-foreground::placeholder { color: #A1A1AA; }
.font-jetbrains { font-family: 'JetBrains Mono', monospace; }
.gap-2 { gap: 0.5rem; }
.text-destructive { color: #EF4444; }
.flex-col { flex-direction: column; }
.sm\\:flex-row { }
@media (min-width: 640px) { .sm\\:flex-row { flex-direction: row; } }
.disabled { opacity: 0.5; cursor: not-allowed; }
.animate-spin { animation: spin 1s linear infinite; }
.items-start { align-items: flex-start; }
.gap-3 { gap: 0.75rem; }
.text-sm { font-size: 0.875rem; }
.flex-shrink-0 { flex-shrink: 0; }
.mt-0\\.5 { margin-top: 0.125rem; }
.information-circle { /* Icon placeholder */ }
.w-full { width: 100%; }
.h-full { height: 100%; }
.opacity-0 { opacity: 0; }
.z-10 { z-index: 10; }
.aspect-square { aspect-ratio: 1; }
.bg-muted { background-color: #2C2C2E; }
.truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.mb-1 { margin-bottom: 0.25rem; }
.border-primary\\/50 { border-color: rgba(0, 212, 255, 0.5); }
.hover\\:shadow-glow-primary:hover { box-shadow: 0 0 10px rgba(0, 212, 255, 0.5); }
.top-3 { top: 0.75rem; }
.left-3 { left: 0.75rem; }
.right-3 { right: 0.75rem; }
.mt-2 { margin-top: 0.5rem; }
.w-48 { width: 12rem; }
.p-2 { padding: 0.5rem; }
.bg-card\\/80 { background-color: rgba(28, 28, 30, 0.8); }
.backdrop-blur-sm { backdrop-filter: blur(4px); }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.hover\\:border-primary:hover { border-color: #00D4FF; }
.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
.flex-1 { flex: 1 1 0%; }
.min-w-0 { min-width: 0; }
.mr-2 { margin-right: 0.5rem; }
.flex-shrink-0 { flex-shrink: 0; }
.w-12 { width: 3rem; }
.h-12 { height: 3rem; }
.w-24 { width: 6rem; }
.h-24 { height: 6rem; }
.flex-wrap { flex-wrap: wrap; }
.sm\\:flex-nowrap { }
@media (min-width: 640px) { .sm\\:flex-nowrap { flex-wrap: nowrap; } }
.border-x { border-left-width: 1px; border-right-width: 1px; }
.p-1 { padding: 0.25rem; }
.h-1 { height: 0.25rem; }
.bg-border { background-color: rgba(255, 255, 255, 0.1); }
.last\\:border-b-0:last-child { border-bottom-width: 0; }
.text-success { color: #10B981; }
.bottom-8 { bottom: 2rem; }
.right-8 { right: 2rem; }
.max-h-96 { max-height: 24rem; }
.overflow-y-auto { overflow-y: auto; }
.border-b { border-bottom-width: 1px; }
.last:border-b-0:last-child { border-bottom-width: 0; }
.p-2 { padding: 0.5rem; }
.hover\\:bg-muted:hover { background-color: #2C2C2E; }
.text-xs { font-size: 0.75rem; }
.font-medium { font-weight: 500; }
.bg-accent\\/20 { background-color: rgba(255, 140, 0, 0.2); }
.bg-primary\\/20 { background-color: rgba(0, 212, 255, 0.2); }
.w-56 { width: 14rem; }
.right-0 { right: 0; }
.mt-2 { margin-top: 0.5rem; }
.justify-between { justify-content: space-between; }
.border-t { border-top-width: 1px; }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.text-warning { color: #F59E0B; }
.inset-0 { inset: 0px; }
.bg-background\\/80 { background-color: rgba(10, 10, 10, 0.8); }
.backdrop-blur-sm { backdrop-filter: blur(4px); }
.z-50 { z-index: 50; }
.p-4 { padding: 1rem; }
.max-w-md { max-width: 28rem; }
.flex-col { flex-direction: column; }
.sm\\:flex-row { }
.items-start { align-items: flex-start; }
.sm\\:items-center { }
@media (min-width: 640px) { .sm\\:items-center { align-items: center; } }
.pl-12 { padding-left: 3rem; }
.pr-4 { padding-right: 1rem; }
.py-4 { padding-top: 1rem; padding-bottom: 1rem; }
.bg-input { background-color: #2C2C2E; }
.placeholder\\:text-muted-foreground::placeholder { color: #A1A1AA; }
.font-jetbrains { font-family: 'JetBrains Mono', monospace; }
.gap-2 { gap: 0.5rem; }
.text-destructive { color: #EF4444; }
.flex-col { flex-direction: column; }
.sm\\:flex-row { }
@media (min-width: 640px) { .sm\\:flex-row { flex-direction: row; } }
.disabled { opacity: 0.5; cursor: not-allowed; }
.animate-spin { animation: spin 1s linear infinite; }
.items-start { align-items: flex-start; }
.gap-3 { gap: 0.75rem; }
.text-sm { font-size: 0.875rem; }
.flex-shrink-0 { flex-shrink: 0; }
.mt-0\\.5 { margin-top: 0.125rem; }
.information-circle { /* Icon placeholder */ }
.w-full { width: 100%; }
.h-full { height: 100%; }
.opacity-0 { opacity: 0; }
.z-10 { z-index: 10; }
.aspect-square { aspect-ratio: 1; }
.bg-muted { background-color: #2C2C2E; }
.object-cover { object-fit: cover; }
.font-semibold { font-weight: 600; }
.truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.mb-1 { margin-bottom: 0.25rem; }
.border-primary\\/50 { border-color: rgba(0, 212, 255, 0.5); }
.hover\\:shadow-glow-primary:hover { box-shadow: 0 0 10px rgba(0, 212, 255, 0.5); }
.top-3 { top: 0.75rem; }
.left-3 { left: 0.75rem; }
.right-3 { right: 0.75rem; }
.mt-2 { margin-top: 0.5rem; }
.w-48 { width: 12rem; }
.p-2 { padding: 0.5rem; }
.bg-card\\/80 { background-color: rgba(28, 28, 30, 0.8); }
.backdrop-blur-sm { backdrop-filter: blur(4px); }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.hover\\:border-primary:hover { border-color: #00D4FF; }
.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
.flex-1 { flex: 1 1 0%; }
.min-w-0 { min-width: 0; }
.mr-2 { margin-right: 0.5rem; }
.flex-shrink-0 { flex-shrink: 0; }
.w-12 { width: 3rem; }
.h-12 { height: 3rem; }
.w-24 { width: 6rem; }
.h-24 { height: 6rem; }
.flex-wrap { flex-wrap: wrap; }
.sm\\:flex-nowrap { }
@media (min-width: 640px) { .sm\\:flex-nowrap { flex-wrap: nowrap; } }
.border-x { border-left-width: 1px; border-right-width: 1px; }
.p-1 { padding: 0.25rem; }
.h-1 { height: 0.25rem; }
.bg-border { background-color: rgba(255, 255, 255, 0.1); }
.last\\:border-b-0:last-child { border-bottom-width: 0; }
.text-success { color: #10B981; }
.bg-card { background-color: #1C1C1E; }
.rounded-xl { border-radius: 12px; }
.border { border-width: 1px; }
.border-glow { border-color: rgba(0, 212, 255, 0.1); }
.p-6 { padding: 1.5rem; }
.shadow-depth-shadow { box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05); }
.flex { display: flex; }
.items-start { align-items: flex-start; }
.justify-between { justify-content: space-between; }
.mb-6 { margin-bottom: 1.5rem; }
.gap-4 { gap: 1rem; }
.w-16 { width: 4rem; }
.h-16 { height: 4rem; }
.rounded-full { border-radius: 50%; }
.overflow-hidden { overflow: hidden; }
.border-2 { border-width: 2px; }
.border-primary { border-color: #00D4FF; }
.glow-primary { box-shadow: 0 0 10px rgba(0, 212, 255, 0.5); }
.bg-gradient-to-br { background: linear-gradient(to bottom right, #00D4FF, #8B5CF6); }
.-bottom-1 { bottom: -4px; }
.-right-1 { right: -4px; }
.p-1\\.5 { padding: 0.375rem; }
.border-card { border-color: #1C1C1E; }
.scale-110 { transform: scale(1.1); }
.text-lg { font-size: 1.125rem; }
.break-all { word-break: break-all; }
.p-2 { padding: 0.5rem; }
.hover\\:bg-muted:hover { background-color: #2C2C2E; }
.rounded-lg { border-radius: 8px; }
.transition-smooth { transition: all 0.3s ease-out; }
.w-56 { width: 14rem; }
.bg-card { background-color: #1C1C1E; }
.border { border-width: 1px; }
.border-glow { border-color: rgba(0, 212, 255, 0.1); }
.shadow-depth-shadow { box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05); }
.overflow-hidden { overflow: hidden; }
.z-20 { z-index: 20; }
.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
.gap-3 { gap: 0.75rem; }
.text-left { text-align: left; }
.border-t { border-top-width: 1px; }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.text-warning { color: #F59E0B; }
.space-y-4 > * + * { margin-top: 1rem; }
.flex { display: flex; }
.items-center { align-items: center; }
.justify-between { justify-content: space-between; }
.mb-2 { margin-bottom: 0.5rem; }
.text-sm { font-size: 0.875rem; }
.font-rajdhani { font-family: 'Rajdhani', sans-serif; }
.text-muted-foreground { color: #A1A1AA; }
.font-jetbrains { font-family: 'JetBrains Mono', monospace; }
.h-2 { height: 0.5rem; }
.bg-muted { background-color: #2C2C2E; }
.rounded-full { border-radius: 9999px; }
.overflow-hidden { overflow: hidden; }
.bg-gradient-to-r { background: linear-gradient(to right, #00D4FF, #8B5CF6); }
.transition-all { transition-property: all; }
.duration-500 { transition-duration: 500ms; }
.glow-primary { box-shadow: 0 0 10px rgba(0, 212, 255, 0.5); }
.p-3 { padding: 0.75rem; }
.bg-muted { background-color: #2C2C2E; }
.rounded-lg { border-radius: 8px; }
.flex-shrink-0 { flex-shrink: 0; }
.mt-0\\.5 { margin-top: 0.125rem; }
.w-2 { width: 0.5rem; }
.h-2 { height: 0.5rem; }
.animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
.fixed { position: fixed; }
.bottom-8 { bottom: 2rem; }
.left-1\\/2 { left: 50%; }
.-translate-x-1\\/2 { transform: translateX(-50%); }
.z-30 { z-index: 30; }
.w-8 { width: 2rem; }
.h-8 { height: 2rem; }
.bg-primary { background-color: #00D4FF; }
.rounded-full { border-radius: 50%; }
.flex { display: flex; }
.items-center { align-items: center; }
.justify-center { justify-content: center; }
.font-jetbrains { font-family: 'JetBrains Mono', monospace; }
.font-bold { font-weight: 700; }
.text-primary-foreground { color: #0A0A0A; }
.text-sm { font-size: 0.875rem; }
.h-6 { height: 1.5rem; }
.w-px { width: 1px; }
.bg-border { background-color: rgba(255, 255, 255, 0.1); }
.px-4 { padding-left: 1rem; padding-right: 1rem; }
.py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
.gap-2 { gap: 0.5rem; }
.transition-smooth { transition: all 0.3s ease-out; }
.bg-destructive\\/10 { background-color: rgba(239, 68, 68, 0.1); }
.bg-destructive\\/20 { background-color: rgba(239, 68, 68, 0.2); }
.text-destructive { color: #EF4444; }
.p-2 { padding: 0.5rem; }
.text-muted-foreground { color: #A1A1AA; }
.flex { display: flex; }
.items-center { align-items: center; }
.gap-2 { gap: 0.5rem; }
.bg-card { background-color: #1C1C1E; }
.border { border-width: 1px; }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.rounded-lg { border-radius: 8px; }
.hover\\:border-primary:hover { border-color: #00D4FF; }
.transition-smooth { transition: all 0.3s ease-out; }
.p-2 { padding: 0.5rem; }
.rounded { border-radius: 0.375rem; }
.text-primary { color: #00D4FF; }
.text-destructive { color: #EF4444; }
.flex { display: flex; }
.items-center { align-items: center; }
.gap-2 { gap: 0.5rem; }
.bg-card { background-color: #1C1C1E; }
.border { border-width: 1px; }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.rounded-lg { border-radius: 8px; }
.p-1 { padding: 0.25rem; }
.hover\\:bg-muted:hover { background-color: #2C2C2E; }
.transition-smooth { transition: all 0.3s ease-out; }
.bg-primary { background-color: #00D4FF; }
.text-primary-foreground { color: #0A0A0A; }
.border-primary { border-color: #00D4FF; }
.hover\\:bg-primary\\/90:hover { background-color: rgba(0, 212, 255, 0.9); }
.border-border { border-color: rgba(255, 255, 255, 0.1); }
.hover\\:bg-accent:hover { background-color: #FF8C00; }
.hover\\:text-accent-foreground:hover { color: #0A0A0A; }
.text-onBackground { color: #FAFAFA; }
.bg-background { background-color: #0A0A0A; }
.p-4 { padding: 1rem; }
.gap-4 { gap: 1rem; }
.justify-center { justify-content: center; }
.inline-flex { display: inline-flex; }
.px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
.duration-200 { transition-duration: 200ms; }
.w-48 { width: 12rem; }
.shadow-depth-shadow { box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5), inset 0 1px 0 rgba(255, 255, 255, 0.05); }
.overflow-hidden { overflow: hidden; }
.text-left { text-align: left; }
.justify-start { justify-content: flex-start; }
.flex-wrap { flex-wrap: wrap; }
.sm\\:flex-nowrap { }
@media (min-width: 640px) { .sm\\:flex-nowrap { flex-wrap: nowrap; } }
.border-x { border-left-width: 1px; border-right-width: 1px; }
.border-primary\\/50 { border-color: rgba(0, 212, 255, 0.5); }
.hover\\:border-primary\\/50:hover { border-color: rgba(0, 212, 255, 0.5); }
/* Add more as needed for dashboard */
.border-dashed { border-style: dashed; }
.p-12 { padding: 3rem; }
.duration-300 { transition-duration: 300ms; }
.bg-primary\\/10 { background-color: rgba(0, 212, 255, 0.1); }
.icon { display: inline-block; vertical-align: middle; width: 1em; height: 1em; }
`;
// Lucide Icons Mapping (Heroicons -> Lucide)
import {
  Key, CloudUpload, ShieldCheck, Smartphone, Shuffle, BarChart, ArrowRight,
  Database, AlertCircle, Loader2, Sparkles, Info, Download, Trash2,
  X, File, Server, CheckCircle, Home, FolderOpen, ArrowLeft, ArrowDown, Upload,
  Clock, Link, Camera, User, Edit3
} from 'lucide-react';
const iconMap = {
  KeyIcon: Key,
  CloudArrowUpIcon: CloudUpload,
  ShieldCheckIcon: ShieldCheck,
  DevicePhoneMobileIcon: Smartphone,
  ArrowsRightLeftIcon: Shuffle,
  ChartBarIcon: BarChart,
  ArrowRightIcon: ArrowRight,
  CircleStackIcon: Database,
  ExclamationCircleIcon: AlertCircle,
  ArrowPathIcon: Loader2,
  SparklesIcon: Sparkles,
  InformationCircleIcon: Info,
  ArrowDownTrayIcon: Download,
  TrashIcon: Trash2,
  XMarkIcon: X,
  DocumentIcon: File,
  ServerIcon: Server,
  CheckCircleIcon: CheckCircle,
  HomeIcon: Home,
  FolderOpenIcon: FolderOpen,
  ArrowLeftIcon: ArrowLeft,
  ArrowDownIcon: ArrowDown,
  UploadIcon: Upload,
  ClockIcon: Clock,
  LinkIcon: Link,
  CameraIcon: Camera,
  UserIcon: User,
  EditIcon: Edit3
};
const Icon = ({ name, size = 24, className = '' }) => {
  const LucideIcon = iconMap[name] || File;
  return <LucideIcon size={size} className={className} />;
};
// --- 3. Component Definitions (Refactored from original files) -----------------
// Helper function for exponential backoff on API calls
const withRetry = (fn, maxRetries = 3, delay = 1000) => async (...args) => {
    for (let i = 0; i < maxRetries; i++) {
        try {
            return await fn(...args);
        } catch (error) {
            if (i === maxRetries - 1) throw error;
            await new Promise(resolve => setTimeout(resolve, delay * Math.pow(2, i)));
        }
    }
};
/**
 * Cloud3D Component
 * Original file: Cloud3D.jsx
 */
const Cloud3D = ({ mousePosition }) => {
  const containerRef = useRef(null);
  const localMousePosition = useMemo(() => {
    // Determine the mouse position relative to the center of the container
    return mousePosition || { x: 0, y: 0 };
  }, [mousePosition]);
  return (
    <div
      ref={containerRef}
      className="relative w-full h-96 flex items-center justify-center overflow-hidden"
    >
      {/* Animated Background Grid */}
      <div className="absolute inset-0 opacity-20">
        <div className="absolute inset-0" style={{
          backgroundImage: `linear-gradient(rgba(0, 212, 255, 0.1) 1px, transparent 1px),
                            linear-gradient(90deg, rgba(0, 212, 255, 0.1) 1px, transparent 1px)`,
          backgroundSize: '50px 50px',
          transform: `perspective(500px) rotateX(60deg) translateZ(-100px)`
        }} />
      </div>
      {/* Floating Particles */}
      {[...Array(20)].map((_, i) =>
        <div
          key={i}
          className="absolute w-1 h-1 bg-primary rounded-full glow-primary animate-float"
          style={{
            left: `${Math.random() * 100}%`,
            top: `${Math.random() * 100}%`,
            animationDelay: `${Math.random() * 5}s`,
            animationDuration: `${5 + Math.random() * 5}s`
          }}
        />
      )}
      {/* Main 3D Cloud Structure */}
      <div
        className="relative w-64 h-64 transition-transform duration-300 ease-out"
        style={{
          transform: `rotateY(${localMousePosition.x * 20}deg) rotateX(${-localMousePosition.y * 20}deg)`
        }}
      >
        {/* Central Core */}
        <div className="absolute inset-0 flex items-center justify-center">
          <div className="w-32 h-32 bg-gradient-to-br from-primary via-secondary to-accent rounded-full glow-primary-strong animate-pulse-slow" />
        </div>
        {/* Orbiting Rings */}
        {[0, 1, 2].map((ring) =>
          <div
            key={ring}
            className="absolute inset-0 border-2 border-primary/30 rounded-full animate-spin-slow"
            style={{
              width: `${160 + ring * 40}px`,
              height: `${160 + ring * 40}px`,
              margin: 'auto',
              animationDuration: `${10 + ring * 5}s`,
              animationDelay: `${ring * 2}s`
            }}
          >
            <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 w-3 h-3 bg-accent rounded-full glow-accent" />
          </div>
        )}
        {/* Geometric Shapes */}
        <div className="absolute top-1/4 left-1/4 w-12 h-12 border-2 border-secondary/50 rotate-45 animate-float glow-secondary" />
        <div className="absolute bottom-1/4 right-1/4 w-16 h-16 border-2 border-primary/50 rounded-full animate-float glow-primary"
          style={{ animationDelay: '2s' }} />
        <div className="absolute top-1/3 right-1/3 w-10 h-10 bg-gradient-to-br from-accent/30 to-transparent rotate-12 animate-float"
          style={{ animationDelay: '4s' }} />
      </div>
      {/* Holographic Text */}
      <div className="absolute bottom-8 left-1/2 -translate-x-1/2 text-center">
        <div className="text-6xl font-orbitron font-black bg-gradient-to-r from-primary via-secondary to-accent bg-clip-text text-transparent animate-pulse-slow">
          Qloud
        </div>
        <div className="text-sm font-inter text-muted-foreground mt-2 tracking-widest">THE FUTURE OF FILE FREEDOM</div>
      </div>
    </div>
  );
};
/**
 * FeatureHighlights Component
 * Original file: FeatureHighlights.jsx
 */
const FeatureHighlights = () => {
  const [features] = useState([
    { title: 'Token-Based Access', description: 'No passwords, no accounts. Just your unique token for instant access to your files.', icon: 'KeyIcon', color: 'from-primary to-secondary' },
    { title: 'Instant Upload', description: 'Drag, drop, and done. Lightning-fast file uploads with real-time progress tracking.', icon: 'CloudArrowUpIcon', color: 'from-accent to-primary' },
    { title: 'Secure Storage', description: 'Military-grade encryption keeps your files safe. Your data, your control.', icon: 'ShieldCheckIcon', color: 'from-secondary to-accent' },
    { title: 'Multi-Device Sync', description: 'Access your files anywhere, anytime. Seamless synchronization across all devices.', icon: 'DevicePhoneMobileIcon', color: 'from-primary to-accent' },
    { title: 'Token Merging', description: 'Consolidate multiple tokens into one. Unified storage management made simple.', icon: 'ArrowsRightLeftIcon', color: 'from-accent to-secondary' },
    { title: 'Real-Time Analytics', description: 'Track your storage usage with live statistics and visual insights.', icon: 'ChartBarIcon', color: 'from-secondary to-primary' }
  ]);
  return (
    <div className="w-full max-w-6xl mx-auto">
      <div className="text-center mb-12">
        <h2 className="text-4xl font-orbitron font-bold text-foreground mb-3">
          Why Choose Qloud?
        </h2>
        <p className="text-lg text-muted-foreground font-inter max-w-2xl mx-auto">Experience the future of cloud storage with features designed for digital freedom</p>
      </div>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {features.map((feature, index) =>
          <div
            key={index}
            className="bg-card/50 backdrop-blur-xl rounded-xl p-6 border border-glow depth-shadow transition-smooth hover:shadow-glow-primary hover:scale-105 group"
          >
            <div className={`w-14 h-14 rounded-xl bg-gradient-to-br ${feature.color} bg-opacity-20 flex items-center justify-center mb-4 group-hover:scale-110 transition-smooth`}>
              <Icon
                name={feature.icon}
                size={28}
                className="text-primary"
              />
            </div>
            <h3 className="text-xl font-orbitron font-bold text-foreground mb-2">
              {feature.title}
            </h3>
            <p className="text-muted-foreground font-inter text-sm leading-relaxed">
              {feature.description}
            </p>
          </div>
        )}
      </div>
    </div>
  );
};
/**
 * StorageMeter Component
 * Original file: StorageMeter.jsx
 */
const StorageMeter = () => {
  const [storage] = useState({
    used: 2.4,
    total: 10,
    percentage: 24
  });
  const formatSize = (gb) => {
    return `${gb.toFixed(1)} GB`;
  };
  const getStorageColor = (percentage) => {
    if (percentage < 50) return 'from-accent to-primary';
    if (percentage < 80) return 'from-warning to-primary';
    return 'from-destructive to-warning';
  };
  return (
    <div className="w-full max-w-md mx-auto">
      <div className="bg-card/50 backdrop-blur-xl rounded-2xl p-6 border border-glow depth-shadow transition-smooth hover:shadow-glow-accent">
        <div className="flex items-center justify-between mb-4">
          <h3 className="text-xl font-orbitron font-bold text-foreground flex items-center gap-2">
            <Icon name="CircleStackIcon" size={24} className="text-primary" />
            Storage Usage
          </h3>
          <div className="px-3 py-1 bg-primary/20 rounded-full">
            <span className="text-sm font-jetbrains font-medium text-primary">
              {storage.percentage}%
            </span>
          </div>
        </div>
        <div className="space-y-4">
          <div className="relative h-4 bg-muted rounded-full overflow-hidden">
            <div
              className={`absolute inset-y-0 left-0 bg-gradient-to-r ${getStorageColor(storage.percentage)} rounded-full transition-all duration-1000 ease-out glow-primary`}
              style={{ width: `${storage.percentage}%` }}
            />
          </div>
          <div className="flex items-center justify-between text-sm font-inter">
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-gradient-to-r from-accent to-primary glow-primary" />
              <span className="text-muted-foreground">Used</span>
              <span className="font-semibold text-foreground font-jetbrains">
                {formatSize(storage.used)}
              </span>
            </div>
            <div className="flex items-center gap-2">
              <span className="text-muted-foreground">Total</span>
              <span className="font-semibold text-foreground font-jetbrains">
                {formatSize(storage.total)}
              </span>
            </div>
          </div>
          <div className="pt-4 border-t border-glow">
            <div className="flex items-center justify-between text-xs text-muted-foreground font-inter">
              <span>Available Space</span>
              <span className="font-semibold text-accent font-jetbrains">
                {formatSize(storage.total - storage.used)} remaining
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
/**
 * TokenInput Component (Refactored for state change routing)
 * Original file: TokenInput.jsx
 */
const TokenInput = ({ onTokenSubmit }) => {
  const [token, setToken] = useState('');
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState('');
  const handleSubmit = (e) => {
    e.preventDefault();
    if (!token.trim()) {
      setError('Please enter a token');
      return;
    }
    setIsLoading(true);
    setError('');
    // Simulate token validation/authentication delay
    setTimeout(() => {
      // In a real app, this would be a validation endpoint.
      // Here, we just assume success and pass the token up to the App component to handle the view change.
      if (onTokenSubmit) {
        onTokenSubmit(token);
      }
      setIsLoading(false);
    }, 1500);
  };
  const generateNewToken = () => {
    const newToken = `QLT-${Math.random().toString(36).substring(2, 15).toUpperCase()}`;
    setToken(newToken);
    setError('');
  };
  return (
    <div className="w-full max-w-2xl mx-auto">
      <div className="bg-card/50 backdrop-blur-xl rounded-2xl p-8 border border-glow depth-shadow transition-smooth hover:shadow-glow-primary">
        <div className="text-center mb-8">
          <h2 className="text-3xl font-orbitron font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent mb-3">
            Enter Your Token
          </h2>
          <p className="text-muted-foreground font-inter">
            Access your cloud storage or create a new token to get started
          </p>
        </div>
        <form onSubmit={handleSubmit} className="space-y-6">
          <div className="relative">
            <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
              <Icon name="KeyIcon" size={20} className="text-primary" />
            </div>
            <input
              type="text"
              value={token}
              onChange={(e) => {
                setToken(e.target.value);
                setError('');
              }}
              placeholder="QLT-XXXXXXXXXXXX"
              className="w-full pl-12 pr-4 py-4 bg-input border border-glow rounded-xl text-foreground placeholder:text-muted-foreground font-jetbrains focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-smooth"
              disabled={isLoading}
            />
          </div>
          {error &&
            <div className="flex items-center gap-2 text-destructive text-sm font-inter">
              <Icon name="ExclamationCircleIcon" size={16} />
              <span>{error}</span>
            </div>
          }
          <div className="flex flex-col sm:flex-row gap-4">
            <button
              type="submit"
              disabled={isLoading}
              className="flex-1 px-6 py-4 bg-gradient-to-r from-primary to-secondary rounded-xl font-rajdhani font-semibold text-primary-foreground hover:shadow-glow-primary-strong transition-smooth hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 flex items-center justify-center gap-2"
            >
              {isLoading ?
                <>
                  <Icon name="ArrowPathIcon" size={20} className="animate-spin" />
                  <span>Authenticating...</span>
                </> :
                <>
                  <Icon name="ArrowRightIcon" size={20} />
                  <span>Access Storage</span>
                </>
              }
            </button>
            <button
              type="button"
              onClick={generateNewToken}
              disabled={isLoading}
              className="px-6 py-4 border border-glow rounded-xl font-rajdhani font-semibold text-primary hover:bg-primary/10 transition-smooth disabled:opacity-50 flex items-center justify-center gap-2"
            >
              <Icon name="SparklesIcon" size={20} />
              <span>Generate New Token</span>
            </button>
          </div>
          <div className="mt-6 pt-6 border-t border-glow">
            <div className="flex items-start gap-3 text-sm text-muted-foreground font-inter">
              <Icon name="InformationCircleIcon" size={20} className="text-primary flex-shrink-0 mt-0.5" />
              <p>
                Your token is your key to access your files. Keep it safe. Lost tokens cannot be recovered.
              </p>
            </div>
          </div>
        </form>
      </div>
    </div>
  );
}
/**
 * TokenStats Component
 * Original file: TokenStats.jsx
 */
const TokenStats = () => {
  const [stats] = useState([
    { label: 'Active Tokens', value: '12,847', icon: 'KeyIcon', color: 'from-primary to-secondary', trend: '+12%' },
    { label: 'Files Stored', value: '2.4M', icon: 'DocumentIcon', color: 'from-accent to-primary', trend: '+8%' },
    { label: 'Total Storage', value: '847 TB', icon: 'ServerIcon', color: 'from-secondary to-accent', trend: '+15%' },
    { label: 'Uptime', value: '99.9%', icon: 'CheckCircleIcon', color: 'from-accent to-secondary', trend: 'Stable' }
  ]);
  return (
    <div className="w-full max-w-6xl mx-auto">
      <div className="text-center mb-8">
        <h2 className="text-3xl font-orbitron font-bold text-foreground mb-2">
          Live Network Statistics
        </h2>
        <p className="text-muted-foreground font-inter">
          Real-time metrics from the Qloud ecosystem
        </p>
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        {stats.map((stat, index) => (
          <div
            key={index}
            className="bg-card/50 backdrop-blur-xl rounded-xl p-6 border border-glow depth-shadow transition-smooth hover:shadow-glow-primary hover:scale-105 group"
          >
            <div className="flex items-start justify-between mb-4">
              <div className={`p-3 rounded-lg bg-gradient-to-br ${stat.color} bg-opacity-20`}>
                <Icon
                  name={stat.icon}
                  size={24}
                  className="text-primary group-hover:scale-110 transition-smooth"
                />
              </div>
              {stat.trend && (
                <div className={`px-2 py-1 rounded-full text-xs font-jetbrains font-medium ${
                  stat.trend.includes('+') ? 'bg-accent/20 text-accent' : 'bg-primary/20 text-primary'
                }`}>
                  {stat.trend}
                </div>
              )}
            </div>
            <div className="space-y-1">
              <div className={`text-3xl font-orbitron font-bold bg-gradient-to-r ${stat.color} bg-clip-text text-transparent`}>
                {stat.value}
              </div>
              <div className="text-sm text-muted-foreground font-inter">
                {stat.label}
              </div>
            </div>
            <div className="mt-4 pt-4 border-t border-glow">
              <div className="flex items-center gap-2 text-xs text-muted-foreground font-inter">
                <div className="w-2 h-2 rounded-full bg-accent animate-pulse" />
                <span>Live Data</span>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}
/**
 * HomepageInteractive Component
 * Original file: HomepageInteractive.jsx
 */
const HomepageInteractive = ({ onTokenSubmit, mousePosition }) => {
  return (
    <div className="space-y-16 py-8">
      {/* Hero Section with 3D Cloud */}
      <section className="relative">
        <Cloud3D mousePosition={mousePosition} />
      </section>
      {/* Token Input Section */}
      <section className="px-4">
        <TokenInput onTokenSubmit={onTokenSubmit} />
      </section>
      {/* Storage Meter Section */}
      <section className="px-4">
        <StorageMeter />
      </section>
      {/* Token Statistics Section */}
      <section className="px-4">
        <TokenStats />
      </section>
      {/* Feature Highlights Section */}
      <section className="px-4">
        <FeatureHighlights />
      </section>
      {/* CTA Section */}
      <section className="px-4">
        <div className="max-w-4xl mx-auto bg-gradient-to-r from-primary/20 via-secondary/20 to-accent/20 backdrop-blur-xl rounded-2xl p-12 border border-glow depth-shadow text-center">
          <h2 className="text-4xl font-orbitron font-bold text-foreground mb-4">
            Start Your Qloud Journey
          </h2>
          <p className="text-lg text-muted-foreground font-inter mb-8">
            Join thousands of users who have already embraced token-based cloud storage.
            Your files, your token, your rules.
          </p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <button className="px-8 py-4 bg-gradient-to-r from-primary to-secondary rounded-xl font-rajdhani font-semibold text-primary-foreground hover:shadow-glow-primary-strong transition-smooth hover:scale-105 text-lg">
              Generate Your Token
            </button>
          </div>
        </div>
      </section>
    </div>
  );
}
/**
 * Homepage Component (Main Page View)
 * Original file: Homepage.jsx
 */
const Homepage = ({ onTokenSubmit, mousePosition }) => {
  // Simple Header for the Homepage
  const Header = () => (
    <header className="fixed top-0 left-0 right-0 z-50 bg-background/90 backdrop-blur-md border-b border-glow">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
        <div className="flex items-center gap-3">
          <Icon name="CloudArrowUpIcon" size={24} className="text-primary glow-primary" />
          <span className="text-xl font-orbitron font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">Qloud</span>
        </div>
        <nav className="hidden md:flex space-x-6 text-sm font-inter">
          {['Features', 'Security', 'Pricing', 'Contact'].map(item => (
            <a key={item} href="#" className="text-muted-foreground hover:text-primary transition-smooth">{item}</a>
          ))}
        </nav>
        <button className="px-4 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-rajdhani hover:bg-primary/90 transition-smooth">
          Access Now
        </button>
      </div>
    </header>
  );
  return (
    <main className="min-h-screen bg-background">
      <Header />
      <div className="pt-20">
        <HomepageInteractive onTokenSubmit={onTokenSubmit} mousePosition={mousePosition} />
      </div>
      {/* Footer */}
      <footer className="mt-24 border-t border-glow bg-card/30 backdrop-blur-xl">
        <div className="max-w-7xl mx-auto px-4 py-8 text-center">
          <p className="text-sm text-muted-foreground font-inter">
            &copy; {new Date().getFullYear()} Qloud. All rights reserved. Built with File Freedom.
          </p>
        </div>
      </footer>
    </main>
  );
}
/**
 * EmptyState Component (For Dashboard)
 * Original file: EmptyState.jsx (Content missing, creating simple version)
 */
const EmptyState = ({ onUploadClick }) => {
    return (
        <div className="text-center p-12 bg-card/50 rounded-xl border border-glow depth-shadow max-w-lg mx-auto mt-12">
            <Icon name="FolderOpenIcon" size={64} className="text-primary mx-auto mb-4 opacity-50" />
            <h3 className="text-xl font-orbitron font-bold text-foreground mb-2">
                No Files Uploaded Yet
            </h3>
            <p className="text-muted-foreground font-inter mb-6">
                Your secure cloud storage is empty. Drag and drop a file or click below to upload your first artifact.
            </p>
            <button
                onClick={onUploadClick}
                className="px-6 py-3 bg-gradient-to-r from-accent to-primary rounded-lg font-rajdhani font-semibold text-primary-foreground hover:shadow-glow-accent transition-smooth hover:scale-[1.02]"
            >
                <Icon name="UploadIcon" size={20} className="inline-block mr-2" />
                Start Uploading
            </button>
        </div>
    );
};
/**
 * BulkActions Component (For Dashboard)
 * Original file: BulkActions.jsx
 */
const BulkActions = ({ selectedCount, onDownloadSelected, onDeleteSelected, onClearSelection }) => {
    if (selectedCount === 0) return null;
    return (
        <div className="fixed bottom-8 left-1/2 -translate-x-1/2 bg-card border border-glow rounded-xl shadow-2xl p-4 flex items-center gap-4 z-30 glow-primary">
            <div className="flex items-center gap-2">
                <div className="w-8 h-8 bg-primary rounded-full flex items-center justify-center">
                    <span className="font-jetbrains font-bold text-primary-foreground text-sm">
                        {selectedCount}
                    </span>
                </div>
                <span className="font-rajdhani text-foreground">
                    {selectedCount} file{selectedCount > 1 ? 's' : ''} selected
                </span>
            </div>
            <div className="h-6 w-px bg-border" style={{ backgroundColor: 'rgba(255, 255, 255, 0.1)' }} />
            <div className="flex items-center gap-2">
                <button
                    onClick={onDownloadSelected}
                    className="px-4 py-2 bg-primary/10 hover:bg-primary/20 rounded-lg flex items-center gap-2 transition-smooth text-primary"
                    title="Download selected"
                >
                    <Icon name="ArrowDownTrayIcon" size={20} className="text-primary" />
                    <span className="font-rajdhani">Download</span>
                </button>
                <button
                    onClick={onDeleteSelected}
                    className="px-4 py-2 bg-destructive/10 hover:bg-destructive/20 rounded-lg flex items-center gap-2 transition-smooth text-destructive"
                    title="Delete selected"
                >
                    <Icon name="TrashIcon" size={20} className="text-destructive" />
                    <span className="font-rajdhani">Delete</span>
                </button>
                <button
                    onClick={onClearSelection}
                    className="p-2 hover:bg-muted-foreground/10 rounded-lg transition-smooth"
                    title="Clear selection"
                >
                    <Icon name="XMarkIcon" size={20} className="text-muted-foreground" />
                </button>
            </div>
        </div>
    );
};
/**
 * UploadDashboard Component (The target view)
 */
const UploadDashboard = ({ userId, currentToken }) => {
    const [files, setFiles] = useState([]);
    const [loading, setLoading] = useState(true);
    const [selectedFiles, setSelectedFiles] = useState({});
    const [uploading, setUploading] = useState(false);
    const [viewMode, setViewMode] = useState('grid');
    const [searchQuery, setSearchQuery] = useState('');
    const [sortBy, setSortBy] = useState('date-desc');
    const [showMergeModal, setShowMergeModal] = useState(false);
    const [destToken, setDestToken] = useState('');
    const [sourceTokens, setSourceTokens] = useState(['']);
    const [profile, setProfile] = useState({ name: 'Nebula User', avatar: 'https://via.placeholder.com/64?text=U' });
    const fileInputRef = useRef(null);
    const filesCollectionPath = `artifacts/${appId}/users/${userId}/files`;
    const profileRef = doc(db, `artifacts/${appId}/users/${userId}/profile`);
    // Cloudinary Config
    const cloudinaryConfig = {
        cloud_name: 'dzvz7kzin',
        upload_preset: 'mycloud_unsigned',
        folder: 'mycloud'
    };
    // 1. Data Fetching and Real-time Listener (Firestore)
    useEffect(() => {
        if (!userId) return;
        const q = collection(db, filesCollectionPath);
        const unsubscribe = onSnapshot(q, (snapshot) => {
            const fileList = snapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));
            setFiles(fileList);
            setLoading(false);
        }, (error) => {
            console.error("Firestore error:", error);
            setLoading(false);
        });
        return () => unsubscribe();
    }, [userId, filesCollectionPath]);
    // Profile listener
    useEffect(() => {
        if (!userId) return;
        const unsubscribe = onSnapshot(profileRef, (doc) => {
            if (doc.exists()) {
                setProfile({ ...doc.data(), id: doc.id });
            } else {
                setDoc(profileRef, { name: 'Nebula User', avatar: 'https://via.placeholder.com/64?text=U', updatedAt: serverTimestamp() });
            }
        });
        return unsubscribe;
    }, [userId]);
    // 2. File Operations (Cloudinary + Firestore)
    const handleFileUpload = async (files) => {
        if (!userId) {
            console.error("User not authenticated to upload.");
            return;
        }
        setUploading(true);
        for (const file of files) {
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', cloudinaryConfig.upload_preset);
            formData.append('folder', `${cloudinaryConfig.folder}/${userId}`);
            try {
                const response = await fetch(`https://api.cloudinary.com/v1_1/${cloudinaryConfig.cloud_name}/upload`, {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
                if (result.secure_url) {
                    const newFile = {
                        name: file.name,
                        size: (file.size / 1024 / 1024).toFixed(2),
                        type: file.type || 'unknown',
                        uploadTime: serverTimestamp(),
                        url: result.secure_url,
                        public_id: result.public_id
                    };
                    const uploadDocRef = doc(collection(db, filesCollectionPath));
                    await setDoc(uploadDocRef, newFile);
                    console.log("File uploaded to Cloudinary and indexed in Firestore:", uploadDocRef.id);
                }
            } catch (error) {
                console.error('Upload error:', error);
            }
        }
        setUploading(false);
    };
    const handleFileChange = (e) => {
        const files = Array.from(e.target.files);
        if (files.length > 0) {
            handleFileUpload(files);
        }
    };
    const handleDragOver = (e) => {
        e.preventDefault();
        e.stopPropagation();
        e.currentTarget.classList.add('border-primary', 'bg-primary/10', 'glow-primary');
    };
    const handleDragLeave = (e) => {
        e.preventDefault();
        e.stopPropagation();
        e.currentTarget.classList.remove('border-primary', 'bg-primary/10', 'glow-primary');
    };
    const handleDrop = (e) => {
        e.preventDefault();
        e.stopPropagation();
        e.currentTarget.classList.remove('border-primary', 'bg-primary/10', 'glow-primary');
        const files = Array.from(e.dataTransfer.files);
        if (files.length > 0) {
            handleFileUpload(files);
        }
    };
    const handleToggleSelect = (fileId) => {
        setSelectedFiles(prev => ({
            ...prev,
            [fileId]: !prev[fileId]
        }));
    };
    const selectedCount = Object.values(selectedFiles).filter(Boolean).length;
    const handleClearSelection = () => {
        setSelectedFiles({});
    };
    const handleDeleteSelected = async () => {
        if (!window.confirm(`Are you sure you want to delete ${selectedCount} files? This action cannot be undone.`)) return;
        const selectedIds = Object.keys(selectedFiles).filter(id => selectedFiles[id]);
        const batch = writeBatch(db);
        selectedIds.forEach(id => {
            batch.delete(doc(db, filesCollectionPath, id));
        });
        try {
            await batch.commit();
            handleClearSelection();
            console.log(`${selectedIds.length} files deleted from Firestore. Note: Cloudinary files not deleted (requires admin API).`);
        } catch (error) {
            console.error("Error deleting selected files:", error);
        }
    };
    const handleDownloadSelected = () => {
        const selectedFileObjects = files.filter(f => selectedFiles[f.id]);
        if (selectedFileObjects.length === 0) return;
        selectedFileObjects.forEach(file => {
            const a = document.createElement('a');
            a.href = file.url;
            a.download = file.name;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        });
    };
    const handleDeleteFile = async (fileId) => {
        if (!window.confirm('Delete this file? This action cannot be undone.')) return;
        await withRetry(deleteDoc, 3)(doc(db, filesCollectionPath, fileId));
    };
    const handleDownloadFile = (file) => {
        const a = document.createElement('a');
        a.href = file.url;
        a.download = file.name;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    };
    // Profile update
    const handleProfileUpdate = async (updates) => {
        await setDoc(profileRef, { ...profile, ...updates, updatedAt: serverTimestamp() }, { merge: true });
    };
    const handleAvatarChange = async (e) => {
        const file = e.target.files[0];
        if (file) {
            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', cloudinaryConfig.upload_preset);
            formData.append('folder', `${cloudinaryConfig.folder}/avatars`);
            try {
                const response = await fetch(`https://api.cloudinary.com/v1_1/${cloudinaryConfig.cloud_name}/upload`, {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();
                if (result.secure_url) {
                    await handleProfileUpdate({ avatar: result.secure_url });
                }
            } catch (error) {
                console.error('Avatar upload error:', error);
            }
        }
    };
    // Token merge
    const addSourceToken = () => setSourceTokens([...sourceTokens, '']);
    const removeSourceToken = (index) => setSourceTokens(sourceTokens.filter((_, i) => i !== index));
    const mergeTokens = async () => {
        if (!destToken || sourceTokens.filter(s => s.trim()).length === 0) return;
        const destPath = `artifacts/${appId}/users/${destToken}/files`;
        const batch = writeBatch(db);
        for (const sourceToken of sourceTokens.filter(s => s.trim())) {
            if (sourceToken === destToken) continue;
            const sourcePath = `artifacts/${appId}/users/${sourceToken}/files`;
            const q = query(collection(db, sourcePath));
            const snapshot = await getDocs(q);
            snapshot.docs.forEach(sourceDoc => {
                const data = sourceDoc.data();
                const newRef = doc(collection(db, destPath));
                batch.set(newRef, { ...data, mergedFrom: sourceToken, mergedAt: serverTimestamp() });
                batch.delete(sourceDoc.ref);
            });
            // Delete source profile if empty
            const sourceProfileRef = doc(db, `artifacts/${appId}/users/${sourceToken}/profile`);
            await deleteDoc(sourceProfileRef).catch(() => {}); // Ignore if not exist
        }
        await batch.commit();
        setShowMergeModal(false);
        setSourceTokens(['']);
        setDestToken('');
        console.log('Tokens merged successfully.');
    };
    // Logout
    const handleLogout = async () => {
        await signOut(auth);
        localStorage.removeItem('qloud_token');
        window.location.href = '/';
    };
    // Filter and sort files
    const filteredFiles = useMemo(() => {
        let sorted = [...files];
        switch (sortBy) {
            case 'name-asc':
                sorted.sort((a, b) => a.name.localeCompare(b.name));
                break;
            case 'name-desc':
                sorted.sort((a, b) => b.name.localeCompare(a.name));
                break;
            case 'date-desc':
                sorted.sort((a, b) => (b.uploadTime?.toDate?.() || 0) - (a.uploadTime?.toDate?.() || 0));
                break;
            case 'date-asc':
                sorted.sort((a, b) => (a.uploadTime?.toDate?.() || 0) - (b.uploadTime?.toDate?.() || 0));
                break;
            case 'size-desc':
                sorted.sort((a, b) => parseFloat(b.size) - parseFloat(a.size));
                break;
            case 'size-asc':
                sorted.sort((a, b) => parseFloat(a.size) - parseFloat(b.size));
                break;
        }
        return sorted.filter(file => file.name.toLowerCase().includes(searchQuery.toLowerCase()));
    }, [files, searchQuery, sortBy]);
    // Render file item
    const renderFileItem = (file) => (
        <div key={file.id} className={`bg-card rounded-xl p-4 border border-glow transition-smooth hover:shadow-glow-primary ${selectedFiles[file.id] ? 'border-primary glow-primary' : ''}`}>
            <div className="flex items-center gap-3">
                <input
                    type="checkbox"
                    checked={selectedFiles[file.id] || false}
                    onChange={() => handleToggleSelect(file.id)}
                    className="rounded border-2 transition-smooth"
                />
                <Icon name={file.type.startsWith('image/') ? 'Image' : 'File'} size={24} className="text-muted-foreground flex-shrink-0" />
                <div className="flex-1 min-w-0">
                    <p className="font-semibold text-foreground truncate">{file.name}</p>
                    <p className="text-sm text-muted-foreground">{file.size} MB  {file.uploadTime?.toDate ? file.uploadTime.toDate().toLocaleDateString() : 'Unknown'}</p>
                </div>
                <div className="flex gap-2">
                    <button onClick={() => handleDownloadFile(file)} className="p-2 hover:bg-primary/10 rounded transition-smooth">
                        <Icon name="Download" size={16} className="text-primary" />
                    </button>
                    <button onClick={() => handleDeleteFile(file.id)} className="p-2 hover:bg-destructive/10 rounded transition-smooth">
                        <Icon name="Trash2" size={16} className="text-destructive" />
                    </button>
                </div>
            </div>
        </div>
    );
    if (loading) return <div className="text-center py-12"><Icon name="Loader2" size={48} className="animate-spin mx-auto mb-4 text-primary" /><p className="text-muted-foreground">Loading your nebula...</p></div>;
    return (
        <div className="space-y-8">
            {/* Upload Zone */}
            <div
                ref={fileInputRef}
                className="relative border-2 border-dashed rounded-xl p-12 transition-all duration-300 border-border hover:border-primary/50 bg-card/50 cursor-pointer"
                onDragOver={handleDragOver}
                onDragLeave={handleDragLeave}
                onDrop={handleDrop}
            >
                <input type="file" multiple onChange={handleFileChange} className="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10" />
                <div className="flex flex-col items-center justify-center gap-4 pointer-events-none">
                    <div className={`p-6 rounded-full transition-all duration-300 ${uploading ? 'bg-primary/20 glow-primary' : 'bg-muted'}`}>
                        <Icon name="CloudUpload" size={48} className={`transition-colors duration-300 ${uploading ? 'text-primary' : 'text-muted-foreground'}`} />
                    </div>
                    <div className="text-center">
                        <h3 className="text-xl font-orbitron font-bold text-foreground mb-2">
                            {uploading ? 'Uploading...' : 'Upload your files'}
                        </h3>
                        <p className="text-muted-foreground font-inter">
                            Drag & drop files here or click to browse
                        </p>
                        <p className="text-sm text-muted-foreground/60 mt-2 font-jetbrains">
                            Supports all file types  Max 100MB per file
                        </p>
                    </div>
                    <button
                        type="button"
                        className="px-6 py-3 bg-gradient-to-r from-primary to-secondary rounded-lg font-rajdhani font-semibold text-primary-foreground hover:shadow-glow-primary-strong transition-smooth hover:scale-105 pointer-events-auto"
                        onClick={() => fileInputRef.current?.click()}
                    >
                        Select Files
                    </button>
                </div>
            </div>
            {/* Search and Controls */}
            <div className="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                <input
                    type="text"
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                    placeholder="Search files..."
                    className="flex-1 pl-10 pr-4 py-3 bg-input border border-glow rounded-xl text-foreground placeholder:text-muted-foreground font-inter focus:outline-none focus:ring-2 focus:ring-primary transition-smooth"
                />
                <select value={sortBy} onChange={(e) => setSortBy(e.target.value)} className="px-4 py-3 bg-card border border-glow rounded-xl text-foreground font-rajdhani">
                    <option value="date-desc">Newest First</option>
                    <option value="date-asc">Oldest First</option>
                    <option value="name-asc">Name (A-Z)</option>
                    <option value="name-desc">Name (Z-A)</option>
                    <option value="size-desc">Size (Largest)</option>
                    <option value="size-asc">Size (Smallest)</option>
                </select>
                <div className="flex gap-1">
                    <button onClick={() => setViewMode('grid')} className={`p-2 rounded ${viewMode === 'grid' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'}`}>Grid</button>
                    <button onClick={() => setViewMode('list')} className={`p-2 rounded ${viewMode === 'list' ? 'bg-primary text-primary-foreground' : 'text-muted-foreground'}`}>List</button>
                </div>
            </div>
            {/* Files List/Grid */}
            {filteredFiles.length === 0 ? (
                <EmptyState onUploadClick={() => fileInputRef.current?.click()} />
            ) : (
                <div className={viewMode === 'grid' ? 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4' : 'space-y-2'}>
                    {filteredFiles.map(file => renderFileItem(file))}
                </div>
            )}
            {/* Bulk Actions */}
            <BulkActions
                selectedCount={selectedCount}
                onDownloadSelected={handleDownloadSelected}
                onDeleteSelected={handleDeleteSelected}
                onClearSelection={handleClearSelection}
            />
            {/* Merge Modal */}
            {showMergeModal && (
                <div className="fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50 p-4">
                    <div className="bg-card border border-glow rounded-2xl p-6 max-w-md w-full">
                        <div className="flex items-center justify-between mb-4">
                            <h3 className="text-xl font-orbitron font-bold text-foreground">Token Merge</h3>
                            <button onClick={() => setShowMergeModal(false)} className="p-2 hover:bg-muted rounded">
                                <Icon name="X" size={20} />
                            </button>
                        </div>
                        <input
                            type="text"
                            value={destToken}
                            onChange={(e) => setDestToken(e.target.value)}
                            placeholder="Destination Token (current: {currentToken})"
                            className="w-full p-3 mb-4 bg-input border border-glow rounded-xl text-foreground"
                        />
                        <div>
                            <p className="text-sm text-muted-foreground mb-2">Source Tokens:</p>
                            {sourceTokens.map((token, index) => (
                                <div key={index} className="flex gap-2 mb-2">
                                    <input
                                        type="text"
                                        value={token}
                                        onChange={(e) => {
                                            const newTokens = [...sourceTokens];
                                            newTokens[index] = e.target.value;
                                            setSourceTokens(newTokens);
                                        }}
                                        placeholder="Source Token"
                                        className="flex-1 p-3 bg-input border border-glow rounded-xl text-foreground"
                                    />
                                    <button onClick={() => removeSourceToken(index)} className="p-3 text-destructive hover:bg-destructive/10 rounded">
                                        <Icon name="Trash2" size={16} />
                                    </button>
                                </div>
                            ))}
                            <button onClick={addSourceToken} className="text-sm text-primary hover:underline">+ Add Source</button>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button onClick={mergeTokens} className="flex-1 p-3 bg-primary rounded-xl font-rajdhani text-primary-foreground">
                                Merge
                            </button>
                            <button onClick={() => setShowMergeModal(false)} className="flex-1 p-3 border border-glow rounded-xl text-foreground">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            )}
        </div>
    );
    // Sidebar Profile
    return (
        <div className="lg:col-span-1 space-y-6">
            <div className="bg-card rounded-xl border border-glow p-6 depth-shadow">
                <div className="flex items-start justify-between mb-6">
                    <div className="flex items-center gap-4">
                        <div className="relative">
                            <img src={profile.avatar} alt="Avatar" className="w-16 h-16 rounded-full object-cover border-2 border-primary glow-primary" />
                            <input type="file" onChange={handleAvatarChange} accept="image/*" className="absolute inset-0 opacity-0 cursor-pointer" />
                            <button className="absolute -bottom-1 -right-1 p-1.5 bg-primary rounded-full border-2 border-card glow-primary">
                                <Icon name="Camera" size={12} className="text-primary-foreground" />
                            </button>
                        </div>
                        <div>
                            <h3 className="font-orbitron font-bold text-foreground text-lg">Your Token</h3>
                            <p className="text-sm text-muted-foreground font-jetbrains break-all">{currentToken}</p>
                        </div>
                    </div>
                    <button onClick={() => setShowMergeModal(true)} className="p-2 hover:bg-muted rounded">
                        <Icon name="EllipsisVerticalIcon" size={20} />
                    </button>
                </div>
                <input
                    type="text"
                    value={profile.name}
                    onChange={(e) => handleProfileUpdate({ name: e.target.value })}
                    placeholder="Display Name"
                    className="w-full p-3 mb-4 bg-input border border-glow rounded-xl text-foreground font-rajdhani"
                />
                <div className="space-y-4 text-sm">
                    <div className="flex justify-between">
                        <span className="text-muted-foreground">Files</span>
                        <span className="font-jetbrains font-bold text-primary">{files.length}</span>
                    </div>
                    <div className="flex justify-between">
                        <span className="text-muted-foreground">Storage Used</span>
                        <span className="font-jetbrains font-bold text-accent">
                            {((files.reduce((sum, f) => sum + parseFloat(f.size || 0), 0) / 100).toFixed(1)} / 100 GB
                        </span>
                    </div>
                </div>
                <button onClick={handleLogout} className="w-full mt-4 p-3 bg-destructive rounded-xl text-destructive-foreground font-rajdhani">
                    Logout
                </button>
            </div>
        </div>
    );
};
/**
 * App Component - Main Entry Point
 */
const App = () => {
    const [currentView, setCurrentView] = useState('home');
    const [currentToken, setCurrentToken] = useState(localStorage.getItem('qloud_token') || null);
    const [userId, setUserId] = useState(null);
    const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });
    // Firebase Init
    useEffect(() => {
        let app;
        try {
            app = initializeApp(firebaseConfig, appId);
        } catch (e) {
            app = getApp();
        }
        auth = getAuth(app);
        db = getFirestore(app);
        // Anonymous auth
        const unsubscribe = onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in
            } else {
                signInAnonymously(auth).catch(console.error);
            }
        });
        return unsubscribe;
    }, []);
    // Mouse position for 3D
    useEffect(() => {
        const handleMouseMove = (e) => {
            setMousePosition({ x: (e.clientX / window.innerWidth) * 2 - 1, y: -(e.clientY / window.innerHeight) * 2 + 1 });
        };
        window.addEventListener('mousemove', handleMouseMove);
        return () => window.removeEventListener('mousemove', handleMouseMove);
    }, []);
    // Token submit handler
    const handleTokenSubmit = async (token) => {
        localStorage.setItem('qloud_token', token);
        setCurrentToken(token);
        const userRef = doc(db, `artifacts/${appId}/users/${token}`);
        try {
            await setDoc(userRef, { createdAt: serverTimestamp() }, { merge: true });
            setUserId(token);
            setCurrentView('dashboard');
        } catch (error) {
            console.error('Error creating token:', error);
        }
    };
    if (currentView === 'home') {
        return <Homepage onTokenSubmit={handleTokenSubmit} mousePosition={mousePosition} />;
    }
    return <UploadDashboard userId={userId} currentToken={currentToken} />;
};
// Render custom styles
useEffect(() => {
    const style = document.createElement('style');
    style.textContent = customStyles;
    document.head.appendChild(style);
    return () => document.head.removeChild(style);
}, []);
export default App;
