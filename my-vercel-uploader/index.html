<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cloud Storage Portal</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
  body {
    background-color: #f8fafc;
    font-family: 'Inter', system-ui, sans-serif;
    color: #1e293b;
  }

  .card-glass {
    background: #ffffff;
    border: 1px solid #e2e8f0;
    border-radius: 16px;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
  }

  .primary-btn {
    background: #6366f1;
    color: #ffffff;
    transition: background 0.2s;
  }

  .primary-btn:hover {
    background: #4f46e5;
  }

  /* Custom Alert Replacement UI */
  #msgBox {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 24px;
    border-radius: 8px;
    display: none;
    z-index: 100;
    font-weight: 500;
  }
</style>
</head>

<body class="min-h-screen flex items-center justify-center p-6">

<div id="msgBox"></div>

<div class="max-w-md w-full">

  <!-- MAIN INTERACTION PANEL -->
  <div class="card-glass p-8">
    <h2 class="text-2xl font-bold text-slate-900 mb-2 text-center">Enter your token</h2>
    <p class="text-sm text-slate-500 mb-8 text-center">
      If the token exists, youâ€™ll enter it. If not, it will be created automatically.
    </p>

    <div class="flex flex-col gap-3">
      <div class="flex gap-2">
        <input
          id="tokenInput"
          type="text"
          placeholder="paste or create token"
          class="flex-1 px-4 py-3 rounded-lg bg-slate-50 border border-slate-200 outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500 transition-all font-mono"
        />
        <button
          id="openBtn"
          class="px-6 py-3 rounded-lg font-semibold primary-btn shadow-sm"
        >
          Open
        </button>
      </div>

      <button
        id="createBtn"
        class="w-full py-3 rounded-lg border border-slate-200 text-slate-600 font-medium hover:bg-slate-50 transition-colors"
      >
        Create new token
      </button>
    </div>
  </div>

</div>

<script>
/* ================================
   UI HELPERS
================================ */
function showMsg(text, type = 'error') {
  const box = document.getElementById('msgBox');
  box.textContent = text;
  box.style.display = 'block';
  box.style.background = type === 'error' ? '#fee2e2' : '#dcfce7';
  box.style.color = type === 'error' ? '#991b1b' : '#166534';
  box.style.border = `1px solid ${type === 'error' ? '#fecaca' : '#bbf7d0'}`;
  
  setTimeout(() => { box.style.display = 'none'; }, 3000);
}

/* ================================
   INFINITE ANIME NAME GENERATOR
================================ */

const prefixes = [
  "Shadow", "Crimson", "Void", "Eternal", "Golden", "Dark", "Holy", "Silent", 
  "Burning", "Frozen", "Storm", "Lunar", "Solar", "Iron", "Mystic", "Phantom", 
  "Ghost", "Omega", "Alpha", "Zen", "Blazing", "Hidden", "Raging", "Cursed"
];

const suffixes = [
  "Slayer", "Hokage", "Shinobi", "Reaper", "Titan", "Hunter", "Pirate", "King", 
  "Queen", "Knight", "Spirit", "Demon", "God", "Hero", "Villain", "Warrior", 
  "Sage", "Master", "Legend", "Ronin", "Samurai", "Bender", "Alchemist"
];

const coreNames = [
  "Naruto", "Sasuke", "Luffy", "Zoro", "Goku", "Vegeta", "Ichigo", "Rukia", 
  "Tanjiro", "Nezuko", "Zenitsu", "Inosuke", "Mikasa", "Eren", "Levi", "Armin",
  "Saitama", "Genos", "Deku", "Bakugo", "Todoroki", "Gojo", "Itadori", "Megumi",
  "Nobara", "Killua", "Gon", "Kurapika", "Hisoka", "Edward", "Alphonse", "Mustang",
  "Spike", "Faye", "Jet", "Alucard", "Seras", "Kaneki", "Touka", "Kirito", 
  "Asuna", "Sinon", "Natsu", "Lucy", "Gray", "Erza", "Light", "Ryuk", "Lelouch", 
  "Suzaku", "Shinji", "Rei", "Asuka", "Mitsuha", "Taki", "Rimuru", "Ainz",
  "Soma", "Erina", "Meliodas", "Ban", "King", "Escanor", "Guts", "Griffith",
  "Yusuke", "Hiei", "Kurama", "Kenshin", "Vash", "Mugen", "Jin", "Alibaba", "Morgiana"
];

function generateCoolAnimeToken() {
  const roll = Math.random();
  const name = coreNames[Math.floor(Math.random() * coreNames.length)];
  
  if (roll < 0.4) {
    // Prefix style (e.g. Shadow-Naruto)
    const pre = prefixes[Math.floor(Math.random() * prefixes.length)];
    return `${pre} ${name}`;
  } else if (roll < 0.8) {
    // Suffix style (e.g. Luffy-King)
    const suf = suffixes[Math.floor(Math.random() * suffixes.length)];
    return `${name} ${suf}`;
  } else {
    // Full Combo (e.g. Dark-Zoro-Slayer)
    const pre = prefixes[Math.floor(Math.random() * prefixes.length)];
    const suf = suffixes[Math.floor(Math.random() * suffixes.length)];
    return `${pre} ${name} ${suf}`;
  }
}

/* ================================
   TOKEN HANDLING
================================ */

const tokenInput = document.getElementById('tokenInput');
const openBtn = document.getElementById('openBtn');
const createBtn = document.getElementById('createBtn');

async function ensureToken(token) {
  const res = await fetch('/api/token', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ token })
  });

  const data = await res.json();
  if (!res.ok) throw new Error(data.error || 'Token API error');
  return data;
}

openBtn.onclick = async () => {
  const token = tokenInput.value.trim();
  if (!token) return showMsg('Please enter a token');

  try {
    await ensureToken(token);
    window.location.href = `/upload.html?token=${encodeURIComponent(token)}`;
  } catch (e) {
    showMsg('Failed to verify token');
  }
};

createBtn.onclick = async () => {
  const token = generateCoolAnimeToken();
  tokenInput.value = token;

  try {
    await ensureToken(token);
    showMsg('Token created: ' + token, 'success');
  } catch (e) {
    showMsg('Failed to create new token');
  }
};
</script>

</body>
</html>
